(this["webpackJsonpaave-react"]=this["webpackJsonpaave-react"]||[]).push([[0],{208:function(e,t,n){},210:function(e,t,n){},224:function(e,t){},227:function(e,t){},230:function(e,t){},234:function(e,t){},261:function(e,t){},263:function(e,t){},277:function(e,t){},279:function(e,t){},310:function(e,t){},312:function(e,t){},404:function(e,t){},405:function(e,t){},498:function(e,t,n){},500:function(e,t,n){"use strict";n.r(t);n(203);var r=n(16),a=n.n(r),s=n(199),c=n.n(s),o=(n(208),n(14)),i=n(46),l=n(17),u=n.n(l),d=(n(210),n(4)),b=n(5),h=n(20),j=n(9),p=n(10),O=n(79),x=n.n(O),v=(n(498),n(1)),m=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={value:r.props.address},r.address=r.state.value,r.stateChanger=r.props.stateChanger,r.handleChange=r.handleChange.bind(Object(h.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(h.a)(r)),r.connectMetamask=r.connectMetamask.bind(Object(h.a)(r)),r}return Object(b.a)(n,[{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this.state.value.toLowerCase();x.a.utils.isAddress(t)?(this.stateChanger(t),this.address=t):alert("Invalid ethereum address: "+t),e.preventDefault()}},{key:"connectMetamask",value:function(){var e=Object(i.a)(u.a.mark((function e(t){var n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){return(r=Object(i.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new x.a(x.a.givenProvider||"ws://localhost:8545"),e.next=3,t.eth.requestAccounts();case 3:return n=e.sent,console.log("update state",n[0]),e.abrupt("return",n[0].toLowerCase());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)},n=function(){return r.apply(this,arguments)},console.log("event",t),e.next=5,n();case 5:a=e.sent,console.log("mmaccount",a),this.setState({value:a}),this.stateChanger(a),this.address=a;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(v.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(v.jsx)("div",{className:"row",children:Object(v.jsx)("div",{className:"col",children:Object(v.jsx)("button",{type:"button",className:"btn btn-primary float-end",onClick:this.connectMetamask,children:"Connect Metamask"})})}),Object(v.jsx)("div",{className:"row",children:Object(v.jsxs)("div",{className:"col",children:[Object(v.jsxs)("label",{children:["Address:",Object(v.jsx)("input",{type:"text",value:this.state.value,onChange:this.handleChange})]}),Object(v.jsx)("input",{type:"submit",value:"Manual Lookup",className:"btn btn-secondary"})]})}),Object(v.jsxs)("p",{children:["Current Account: ",this.address]})]})}}]),n}(r.Component),f=m,g=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={value:r.props.network},r.stateChanger=r.props.stateChanger,r.handleChange=r.handleChange.bind(Object(h.a)(r)),r}return Object(b.a)(n,[{key:"handleChange",value:function(e){this.setState({value:e.target.value}),this.stateChanger(e.target.value)}},{key:"render",value:function(){return Object(v.jsx)("form",{children:Object(v.jsxs)("label",{children:["Network:",Object(v.jsxs)("select",{value:this.state.value,onChange:this.handleChange,children:[Object(v.jsx)("option",{value:"eth",children:"Mainnet"}),Object(v.jsx)("option",{value:"avax",children:"Avalanche"}),Object(v.jsx)("option",{value:"matic",children:"Matic"})]})]})})}}]),n}(r.Component),w=n(505),k=Intl.NumberFormat("en-US",{style:"currency",currency:"USD",currencySign:"accounting"}),y=Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2}),S="https://api.thegraph.com/subgraphs/name/aave/protocol-v2-avalanche",C="https://api.thegraph.com/subgraphs/name/aave/aave-v2-matic",A="https://api.thegraph.com/subgraphs/name/aave/protocol-v2",T="\nquery {\n  reserves (where: {\n    usageAsCollateralEnabled: true\n  }) {\n    id\n    name\n    price {\n      id\n      priceInEth\n    }\n    liquidityRate\n    variableBorrowRate\n    stableBorrowRate\n    aEmissionPerSecond\n    vEmissionPerSecond\n    decimals\n    totalATokenSupply\n    totalCurrentVariableDebt\n    symbol\n  }\n}\n",D={};function F(e){return E.apply(this,arguments)}function E(){return(E=Object(i.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=t.replace(".e","").replace("W",""))in D)){e.next=4;break}e.next=17;break;case 4:if("USDT"===t){e.next=16;break}if("XSUSHI"===t){e.next=11;break}return e.next=8,fetch("https://api.binance.com/api/v3/ticker/price?symbol=".concat(t,"USDT")).then((function(e){return e.json()})).catch((function(e){return-1})).then((function(e){return e.hasOwnProperty("price")?parseFloat(e.price):(console.log("fetched from binance: ",t,D[t]),-1)}));case 8:D[t]=e.sent,e.next=14;break;case 11:return e.next=13,fetch("https://api.coingecko.com/api/v3/simple/price?ids=".concat(t,"&vs_currencies=usd")).then((function(e){return e.json()})).catch((function(e){return-1})).then((function(e){return e.hasOwnProperty(t.toLowerCase())?parseFloat(e[t.toLowerCase()].usd):(console.log("fetched from coingecko: ",t,D[t]),-1)}));case 13:D[t]=e.sent;case 14:e.next=17;break;case 16:return e.abrupt("return",1);case 17:return e.abrupt("return",D[t]);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){return I.apply(this,arguments)}function I(){return(I=Object(i.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(t);case 2:return n=e.sent,e.next=5,F("ETH");case 5:return r=e.sent,console.log("eth price of ",t,r),e.abrupt("return",n/r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=Object(w.a)({url:S}),N=Object(w.a)({url:A}),U={matic:Object(w.a)({url:C}),avax:M,eth:N},P={matic:"WMATIC",avax:"WAVAX",eth:"WETH"};var B=function(){var e=Math.pow(10,27),t=Math.pow(10,18),n=Math.pow(10,18),a=31536e3,s=Object(r.useState)(""),c=Object(o.a)(s,2),l=c[0],d=c[1],b=Object(r.useState)("avax"),h=Object(o.a)(b,2),j=h[0],p=h[1],O=Object(r.useState)({}),x=Object(o.a)(O,2),m=x[0],w=x[1],S=Object(r.useState)([]),C=Object(o.a)(S,2),A=(C[0],C[1]),D=Object(r.useState)([]),E=Object(o.a)(D,2),I=E[0],M=E[1],N=Object(r.useState)({}),B=Object(o.a)(N,2),L=B[0],W=B[1],_=Object(r.useState)([]),q=Object(o.a)(_,2),V=q[0],H=q[1],X=Object(r.useState)({}),J=Object(o.a)(X,2),Y=J[0],z=J[1];function G(){return(G=Object(i.a)(u.a.mark((function r(){var s,c,i,d,b,h,p,O,x,v,m,f,g,S,C,D,E,I,N,B,L,_,q,V,X,J,Y,G,K,Q,Z,$,ee,te,ne,re,ae,se,ce,oe,ie,le,ue,de,be,he,je,pe,Oe,xe,ve,me,fe,ge,we,ke,ye;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(l&&0!==l.length){r.next=2;break}return r.abrupt("return");case 2:return A([]),M([]),W({}),w({}),H([]),z({}),s='\n    {\n      userReserves(where: { user: "'.concat(l,'"}) {\n        id\n        reserve{\n          id\n          symbol\n        }\n        currentATokenBalance\n        currentTotalDebt\n      }\n    }\n    '),console.log("query",s),c=U[j],i=P[j],r.next=14,c.query(s).toPromise();case 14:d=r.sent,console.log("resp",d),A(d.data.userReserves),b=[],h={deposits:0,debt:0,sum:0},p=[],O={native:0,rewards:0,sum:0},x=["ETH","MATIC","AVAX"],v=0;case 23:if(!(v<d.data.userReserves.length)){r.next=47;break}return m=d.data.userReserves[v],f=m.reserve.symbol,g=parseFloat(m.currentATokenBalance)/t,S=parseFloat(m.currentTotalDebt)/t,C={symbol:f,debt:0,deposits:0},console.log("tally",f,g,S),r.next=32,F(f);case 32:if(-1!==(D=r.sent)){r.next=35;break}return r.abrupt("continue",44);case 35:g>0&&(C.deposits+=g*D),S>0&&(C.debt+=S*D),h.deposits+=C.deposits,h.debt+=C.debt,h.sum+=C.deposits-C.debt,C.sum=k.format(C.deposits-C.debt),C.deposits=k.format(C.deposits),C.debt=k.format(C.debt),(g>0||S>0)&&(x.push(f),b.push(C));case 44:v++,r.next=23;break;case 47:return console.log("token list",x),console.log(j),console.log(c),r.next=52,c.query(T).toPromise();case 52:return E=r.sent,I={},r.next=56,R(i.replace("W",""));case 56:N=r.sent,v=0;case 58:if(!(v<E.data.reserves.length)){r.next=90;break}if(B=E.data.reserves[v],L=B.symbol,console.log("111111",L,x),x.includes(L)){r.next=64;break}return r.abrupt("continue",87);case 64:return _=parseFloat(B.variableBorrowRate),q=parseFloat(B.liquidityRate),V=parseFloat(B.aEmissionPerSecond),X=parseFloat(B.vEmissionPerSecond),J=parseFloat(B.totalCurrentVariableDebt),Y=parseFloat(B.totalATokenSupply),r.next=72,R(L);case 72:G=r.sent,K=Math.pow(10,parseFloat(B.decimals)),Q=q/e,Z=_/e,$=V*a,ee=X*a,console.log("======================== "+L+" ================================="),console.log("(aEmissionPerYear * REWARD_PRICE_ETH * WEI_DECIMALS)",$,N,t),console.log("(totalATokenSupply * token_price_eth * underlying_token_decimals)",Y,G,K),console.log("======================== "+L+" ================================="),te=$*N*K/(Y*G*n),ne=ee*N*K/(J*G*n),I[L]={deposit:{native:Q},borrow:{native:Z}},I[L].deposit.rewards=te,I[L].borrow.rewards=J>0?ne:0;case 87:v++,r.next=58;break;case 90:console.log("rate",I),w(I),v=0;case 93:if(!(v<d.data.userReserves.length)){r.next=127;break}if(re=d.data.userReserves[v],ae=re.reserve.symbol,x.includes(ae)&&"USDT"!==ae){r.next=98;break}return r.abrupt("continue",124);case 98:if(console.log(ae,x),se=parseFloat(re.currentATokenBalance)/t,ce=parseFloat(re.currentTotalDebt)/t,0!==se||0!==ce){r.next=103;break}return r.abrupt("continue",124);case 103:return console.log("Annual rewards for this symbol",ae),oe=se*I[ae].deposit.native-ce*I[ae].borrow.native,r.next=107,F(ae);case 107:return ie=r.sent,le=oe*ie,console.log("nativeusd",le),r.next=112,F("AVAX");case 112:ue=r.sent,de=se*ie*I[ae].deposit.rewards,be=ce*ie*I[ae].borrow.rewards,he=(de+be)/ue,console.log(ae+" Rewards",de,be),je=de+be,console.log("rewards",je),O.native+=le,O.rewards+=je,O.sum+=le+je,pe={symbol:ae,native:{USD:k.format(le),native:oe},rewards:{USD:k.format(je),WAVAX:he},total:{USD:k.format(le+je)}},p.push(pe);case 124:v++,r.next=93;break;case 127:for(Oe=0,xe=Object.entries(I);Oe<xe.length;Oe++)for(ve=Object(o.a)(xe[Oe],2),me=ve[0],fe=ve[1],ge=0,we=Object.entries(fe);ge<we.length;ge++)ke=Object(o.a)(we[ge],2),ye=ke[0],ke[1],console.log("1",I[me][ye].native),console.log("2",I[me][ye].rewards),I[me][ye].native=y.format(I[me][ye].native),I[me][ye].rewards=y.format(I[me][ye].rewards),console.log("3",I[me][ye].native),console.log("4",I[me][ye].rewards);console.log(I),w(I),h.deposits=k.format(h.deposits),h.debt=k.format(h.debt),h.sum=k.format(h.sum),O.native=k.format(O.native),O.rewards=k.format(O.rewards),O.sum=k.format(O.sum),console.log("subtotals",b),console.log("totals",h),console.log("annual subtotals",p),M(b),W(h),H(p),z(O);case 143:case"end":return r.stop()}}),r)})))).apply(this,arguments)}return Object(r.useEffect)((function(){!function(){G.apply(this,arguments)}()}),[l,j]),Object(v.jsx)("div",{className:"App",children:Object(v.jsxs)("div",{className:"container mt-4",children:[Object(v.jsx)(f,{address:l,stateChanger:d}),Object(v.jsx)(g,{network:j,stateChanger:p}),Object(v.jsx)("hr",{}),Object(v.jsx)("h3",{children:"Current Rates"}),Object(v.jsxs)("table",{className:"table",children:[Object(v.jsx)("thead",{children:Object(v.jsxs)("tr",{children:[Object(v.jsx)("th",{scope:"col",children:"Token"}),Object(v.jsx)("th",{scope:"col",children:"Deposit"}),Object(v.jsx)("th",{scope:"col",children:"Deposit Incentives"}),Object(v.jsx)("th",{scope:"col",children:"Borrow"}),Object(v.jsx)("th",{scope:"col",children:"Borrow Incentives"})]})}),Object(v.jsx)("tbody",{children:Object.entries(m).map((function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(v.jsxs)("tr",{children:[Object(v.jsx)("th",{scope:"row",children:n}),Object(v.jsx)("td",{children:r.deposit.native}),Object(v.jsx)("td",{children:r.deposit.rewards}),Object(v.jsx)("td",{children:r.borrow.native}),Object(v.jsx)("td",{children:r.borrow.rewards})]})}))})]}),Object(v.jsx)("br",{}),Object(v.jsx)("h3",{children:"User Balances (USD)"}),Object(v.jsxs)("table",{className:"table",children:[Object(v.jsx)("thead",{children:Object(v.jsxs)("tr",{children:[Object(v.jsx)("th",{scope:"col",children:"Token"}),Object(v.jsx)("th",{scope:"col",children:"Deposits"}),Object(v.jsx)("th",{scope:"col",children:"Borrows"}),Object(v.jsx)("th",{scope:"col",children:"Total"})]})}),Object(v.jsxs)("tbody",{children:[I.map((function(e,t){return Object(v.jsxs)("tr",{children:[Object(v.jsx)("th",{scope:"row",children:e.symbol}),Object(v.jsx)("td",{children:e.deposits}),Object(v.jsx)("td",{children:e.debt}),Object(v.jsx)("td",{children:e.sum})]})})),Object(v.jsxs)("tr",{children:[Object(v.jsx)("th",{scope:"row",children:"Total"}),Object(v.jsx)("td",{children:L.deposits}),Object(v.jsx)("td",{children:L.debt}),Object(v.jsx)("td",{children:L.sum})]})]})]}),Object(v.jsx)("br",{}),Object(v.jsx)("h3",{children:"Annual Rewards (projected)"}),Object(v.jsxs)("table",{className:"table",children:[Object(v.jsx)("thead",{children:Object(v.jsxs)("tr",{children:[Object(v.jsx)("th",{scope:"col",children:"Token"}),Object(v.jsx)("th",{scope:"col",children:"Native Interest"}),Object(v.jsx)("th",{scope:"col",children:"Incentives"}),Object(v.jsx)("th",{scope:"col",children:"Total"})]})}),Object(v.jsxs)("tbody",{children:[V.map((function(e,t){return Object(v.jsxs)("tr",{children:[Object(v.jsx)("th",{scope:"row",children:e.symbol}),Object(v.jsx)("td",{children:e.native.USD}),Object(v.jsx)("td",{children:e.rewards.USD}),Object(v.jsx)("td",{children:e.total.USD})]})})),Object(v.jsxs)("tr",{children:[Object(v.jsx)("th",{scope:"row",children:"Total"}),Object(v.jsx)("td",{children:Y.native}),Object(v.jsx)("td",{children:Y.rewards}),Object(v.jsx)("td",{children:Y.sum})]})]})]})]})})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,506)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),s(e),c(e)}))};c.a.render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(B,{})}),document.getElementById("root")),L()}},[[500,1,2]]]);
//# sourceMappingURL=main.07555621.chunk.js.map