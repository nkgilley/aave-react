(this["webpackJsonpaave-react"]=this["webpackJsonpaave-react"]||[]).push([[0],{208:function(e,t,a){},210:function(e,t,a){},224:function(e,t){},227:function(e,t){},230:function(e,t){},234:function(e,t){},261:function(e,t){},263:function(e,t){},277:function(e,t){},279:function(e,t){},310:function(e,t){},312:function(e,t){},404:function(e,t){},405:function(e,t){},498:function(e,t,a){},500:function(e,t,a){"use strict";a.r(t);a(203);var s=a(16),n=a.n(s),c=a(199),r=a.n(c),i=(a(208),a(14)),o=a(46),l=a(17),d=a.n(l),u=(a(210),a(4)),b=a(5),j=a(20),h=a(9),m=a(10),v=a(79),p=a.n(v),x=(a(498),a(1)),O=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(u.a)(this,a),(s=t.call(this,e)).state={value:s.props.address},s.address=s.state.value,s.stateChanger=s.props.stateChanger,s.handleChange=s.handleChange.bind(Object(j.a)(s)),s.handleSubmit=s.handleSubmit.bind(Object(j.a)(s)),s.connectMetamask=s.connectMetamask.bind(Object(j.a)(s)),s}return Object(b.a)(a,[{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this.state.value.toLowerCase();p.a.utils.isAddress(t)?(this.stateChanger(t),this.address=t):alert("Invalid ethereum address: "+t),e.preventDefault()}},{key:"connectMetamask",value:function(){var e=Object(o.a)(d.a.mark((function e(t){var a,s,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(){return(s=Object(o.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new p.a(p.a.givenProvider||"ws://localhost:8545"),e.next=3,t.eth.requestAccounts();case 3:return a=e.sent,console.log("update state",a[0]),e.abrupt("return",a[0].toLowerCase());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)},a=function(){return s.apply(this,arguments)},console.log("event",t),e.next=5,a();case 5:n=e.sent,console.log("mmaccount",n),this.setState({value:n}),this.stateChanger(n),this.address=n;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(x.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(x.jsxs)("label",{children:["Address:",Object(x.jsx)("input",{type:"text",value:this.state.value,onChange:this.handleChange})]}),Object(x.jsx)("input",{type:"submit",value:"Submit",className:"btn btn-secondary"}),Object(x.jsx)("button",{type:"button",className:"btn btn-primary",onClick:this.connectMetamask,children:"Connect Metamask"}),Object(x.jsxs)("p",{children:["Current Account: ",this.address]})]})}}]),a}(s.Component),f=O,g=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(u.a)(this,a),(s=t.call(this,e)).state={value:s.props.network},s.stateChanger=s.props.stateChanger,s.handleChange=s.handleChange.bind(Object(j.a)(s)),s}return Object(b.a)(a,[{key:"handleChange",value:function(e){this.setState({value:e.target.value}),this.stateChanger(e.target.value)}},{key:"render",value:function(){return Object(x.jsx)("form",{children:Object(x.jsxs)("label",{children:["Network:",Object(x.jsxs)("select",{value:this.state.value,onChange:this.handleChange,children:[Object(x.jsx)("option",{value:"eth",children:"Mainnet"}),Object(x.jsx)("option",{value:"avax",children:"Avalanche"}),Object(x.jsx)("option",{value:"matic",children:"Matic"})]})]})})}}]),a}(s.Component),N=a(505),w=Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),k="https://api.thegraph.com/subgraphs/name/aave/protocol-v2-avalanche",y="https://api.thegraph.com/subgraphs/name/aave/aave-v2-matic",S="https://api.thegraph.com/subgraphs/name/aave/protocol-v2",C="\nquery {\n  reserves (where: {\n    usageAsCollateralEnabled: true\n  }) {\n    id\n    name\n    price {\n      id\n      priceInEth\n    }\n    liquidityRate\n    variableBorrowRate\n    stableBorrowRate\n    aEmissionPerSecond\n    vEmissionPerSecond\n    decimals\n    totalATokenSupply\n    totalCurrentVariableDebt\n    symbol\n  }\n}\n",A={};function D(e){return T.apply(this,arguments)}function T(){return(T=Object(o.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=t.replace(".e","").replace("W",""))in A)){e.next=4;break}e.next=17;break;case 4:if("USDT"===t){e.next=16;break}if("XSUSHI"===t){e.next=11;break}return e.next=8,fetch("https://api.binance.com/api/v3/ticker/price?symbol=".concat(t,"USDT")).then((function(e){return e.json()})).catch((function(e){return-1})).then((function(e){return e.hasOwnProperty("price")?parseFloat(e.price):(console.log("fetched from binance: ",t,A[t]),-1)}));case 8:A[t]=e.sent,e.next=14;break;case 11:return e.next=13,fetch("https://api.coingecko.com/api/v3/simple/price?ids=".concat(t,"&vs_currencies=usd")).then((function(e){return e.json()})).catch((function(e){return-1})).then((function(e){return e.hasOwnProperty(t.toLowerCase())?parseFloat(e[t.toLowerCase()].usd):(console.log("fetched from coingecko: ",t,A[t]),-1)}));case 13:A[t]=e.sent;case 14:e.next=17;break;case 16:return e.abrupt("return",1);case 17:return e.abrupt("return",A[t]);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){return F.apply(this,arguments)}function F(){return(F=Object(o.a)(d.a.mark((function e(t){var a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(t);case 2:return a=e.sent,e.next=5,D("ETH");case 5:return s=e.sent,console.log("eth price of ",t,s),e.abrupt("return",a/s);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=Object(N.a)({url:k}),M=Object(N.a)({url:S}),U={matic:Object(N.a)({url:y}),avax:E,eth:M},P={matic:"WMATIC",avax:"WAVAX",eth:"WETH"};var B=function(){var e=Math.pow(10,27),t=Math.pow(10,18),a=Math.pow(10,18),n=31536e3,c=Object(s.useState)(""),r=Object(i.a)(c,2),l=r[0],u=r[1],b=Object(s.useState)("avax"),j=Object(i.a)(b,2),h=j[0],m=j[1],v=Object(s.useState)({}),p=Object(i.a)(v,2),O=p[0],N=p[1],k=Object(s.useState)([]),y=Object(i.a)(k,2),S=(y[0],y[1]),A=Object(s.useState)([]),T=Object(i.a)(A,2),F=T[0],E=T[1],M=Object(s.useState)({}),B=Object(i.a)(M,2),I=B[0],W=B[1],_=Object(s.useState)([]),q=Object(i.a)(_,2),L=q[0],V=q[1],H=Object(s.useState)({}),X=Object(i.a)(H,2),J=X[0],Y=X[1];function z(){return(z=Object(o.a)(d.a.mark((function s(){var c,r,i,o,u,b,j,m,v,p,x,O,f,g,k,y,A,T,F,M,B,I,_,q,L,H,X,J,z,G,K,Q,Z,$,ee,te,ae,se,ne,ce,re,ie,oe,le,de,ue,be,je;return d.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(l&&0!=l.length){s.next=2;break}return s.abrupt("return");case 2:return S([]),E([]),W({}),N({}),V([]),Y({}),c='\n    {\n      userReserves(where: { user: "'.concat(l,'"}) {\n        id\n        reserve{\n          id\n          symbol\n        }\n        currentATokenBalance\n        currentTotalDebt\n      }\n    }\n    '),console.log("query",c),r=U[h],i=P[h],s.next=14,r.query(c).toPromise();case 14:o=s.sent,console.log("resp",o),S(o.data.userReserves),u=[],b={deposits:0,debt:0,sum:0},j=[],m={native:0,rewards:0,sum:0},v=["ETH","MATIC","AVAX"],p=0;case 23:if(!(p<o.data.userReserves.length)){s.next=47;break}return x=o.data.userReserves[p],O=x.reserve.symbol,f=parseFloat(x.currentATokenBalance)/t,g=parseFloat(x.currentTotalDebt)/t,k={symbol:O,debt:0,deposits:0},console.log("tally",O,f,g),s.next=32,D(O);case 32:if(-1!==(y=s.sent)){s.next=35;break}return s.abrupt("continue",44);case 35:f>0&&(k.deposits+=f*y),g>0&&(k.debt+=g*y),b.deposits+=k.deposits,b.debt+=k.debt,b.sum+=k.deposits-k.debt,k.sum=w.format(k.deposits-k.debt),k.deposits=w.format(k.deposits),k.debt=w.format(k.debt),(f>0||g>0)&&(v.push(O),u.push(k));case 44:p++,s.next=23;break;case 47:return console.log("token list",v),console.log(h),console.log(r),s.next=52,r.query(C).toPromise();case 52:return A=s.sent,T={},s.next=56,R(i.replace("W",""));case 56:F=s.sent,p=0;case 58:if(!(p<A.data.reserves.length)){s.next=90;break}if(M=A.data.reserves[p],B=M.symbol,console.log("111111",B,v),v.includes(B)){s.next=64;break}return s.abrupt("continue",87);case 64:return I=parseFloat(M.variableBorrowRate),_=parseFloat(M.liquidityRate),q=parseFloat(M.aEmissionPerSecond),L=parseFloat(M.vEmissionPerSecond),H=parseFloat(M.totalCurrentVariableDebt),X=parseFloat(M.totalATokenSupply),s.next=72,R(B);case 72:J=s.sent,z=Math.pow(10,parseFloat(M.decimals)),G=_/e,K=I/e,Q=q*n,Z=L*n,console.log("======================== "+B+" ================================="),console.log("(aEmissionPerYear * REWARD_PRICE_ETH * WEI_DECIMALS)",Q,F,t),console.log("(totalATokenSupply * token_price_eth * underlying_token_decimals)",X,J,z),console.log("======================== "+B+" ================================="),$=Q*F*z/(X*J*a),ee=Z*F*z/(H*J*a),T[B]={deposit:{native:G},borrow:{native:K}},T[B].deposit.rewards=$,T[B].borrow.rewards=H>0?ee:0;case 87:p++,s.next=58;break;case 90:console.log("rate",T),N(T),p=0;case 93:if(!(p<o.data.userReserves.length)){s.next=127;break}if(te=o.data.userReserves[p],ae=te.reserve.symbol,v.includes(ae)&&"USDT"!==ae){s.next=98;break}return s.abrupt("continue",124);case 98:if(console.log(ae,v),se=parseFloat(te.currentATokenBalance)/t,ne=parseFloat(te.currentTotalDebt)/t,0!==se||0!==ne){s.next=103;break}return s.abrupt("continue",124);case 103:return console.log("Annual rewards for this symbol",ae),ce=se*T[ae].deposit.native-ne*T[ae].borrow.native,s.next=107,D(ae);case 107:return re=s.sent,ie=ce*re,console.log("nativeusd",ie),s.next=112,D("AVAX");case 112:oe=s.sent,le=se*re*T[ae].deposit.rewards,de=ne*re*T[ae].borrow.rewards,ue=(le+de)/oe,console.log(ae+" Rewards",le,de),be=le+de,console.log("rewards",be),m.native+=ie,m.rewards+=be,m.sum+=ie+be,je={symbol:ae,native:{USD:w.format(ie),native:ce},rewards:{USD:w.format(be),WAVAX:ue},total:{USD:w.format(ie+be)}},j.push(je);case 124:p++,s.next=93;break;case 127:b.deposits=w.format(b.deposits),b.debt=w.format(b.debt),b.sum=w.format(b.sum),m.native=w.format(m.native),m.rewards=w.format(m.rewards),m.sum=w.format(m.sum),console.log("subtotals",u),console.log("totals",b),console.log("annual subtotals",j),E(u),W(b),V(j),Y(m);case 140:case"end":return s.stop()}}),s)})))).apply(this,arguments)}return Object(s.useEffect)((function(){!function(){z.apply(this,arguments)}()}),[l,h]),Object(x.jsxs)("div",{className:"App",children:[Object(x.jsx)(f,{address:l,stateChanger:u}),Object(x.jsx)(g,{network:h,stateChanger:m}),Object(x.jsx)("h2",{children:"Current Rates"}),Object(x.jsx)("div",{className:"container table-head",children:Object(x.jsxs)("div",{className:"row align-items-start",children:[Object(x.jsx)("div",{className:"col",children:"Token"}),Object(x.jsx)("div",{className:"col",children:"Deposit Rate"}),Object(x.jsx)("div",{className:"col",children:"Deposit Rewards"}),Object(x.jsx)("div",{className:"col",children:"Borrow Rate"}),Object(x.jsx)("div",{className:"col",children:"Borrow Rewards"})]})}),Object.entries(O).map((function(e){var t=Object(i.a)(e,2),a=t[0],s=t[1];return Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row align-items-start",children:[Object(x.jsx)("div",{className:"col",children:a}),Object(x.jsx)("div",{className:"col",children:100*s.deposit.native}),Object(x.jsx)("div",{className:"col",children:100*s.deposit.rewards}),Object(x.jsx)("div",{className:"col",children:100*s.borrow.native}),Object(x.jsx)("div",{className:"col",children:100*s.borrow.rewards})]})})})),Object(x.jsx)("br",{}),Object(x.jsx)("h2",{children:"User Balances (USD)"}),Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row align-items-start",children:[Object(x.jsx)("div",{className:"col",children:"Token"}),Object(x.jsx)("div",{className:"col",children:"Deposits"}),Object(x.jsx)("div",{className:"col",children:"Borrows"}),Object(x.jsx)("div",{className:"col",children:"Sum"})]})}),Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row align-items-start",children:[Object(x.jsx)("div",{className:"col",children:"============"}),Object(x.jsx)("div",{className:"col",children:"============"}),Object(x.jsx)("div",{className:"col",children:"============"}),Object(x.jsx)("div",{className:"col",children:"============"})]})}),F.map((function(e,t){return Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row align-items-start",children:[Object(x.jsx)("div",{className:"col",children:e.symbol}),Object(x.jsx)("div",{className:"col",children:e.deposits}),Object(x.jsx)("div",{className:"col",children:e.debt}),Object(x.jsx)("div",{className:"col",children:e.sum})]})})})),Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row align-items-start",children:[Object(x.jsx)("div",{className:"col",children:"============"}),Object(x.jsx)("div",{className:"col",children:"============"}),Object(x.jsx)("div",{className:"col",children:"============"}),Object(x.jsx)("div",{className:"col",children:"============"})]})}),Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row align-items-start",children:[Object(x.jsx)("div",{className:"col"}),Object(x.jsx)("div",{className:"col",children:I.deposits}),Object(x.jsx)("div",{className:"col",children:I.debt}),Object(x.jsx)("div",{className:"col",children:I.sum})]})}),Object(x.jsx)("br",{}),Object(x.jsx)("h2",{children:"Annual Rewards (current rates extrapolated)"}),Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row align-items-start",children:[Object(x.jsx)("div",{className:"col",children:"Token"}),Object(x.jsx)("div",{className:"col",children:"Native Rewards"}),Object(x.jsx)("div",{className:"col",children:"Incentives"}),Object(x.jsx)("div",{className:"col",children:"Sum"})]})}),Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row align-items-start",children:[Object(x.jsx)("div",{className:"col",children:"============"}),Object(x.jsx)("div",{className:"col",children:"============"}),Object(x.jsx)("div",{className:"col",children:"============"}),Object(x.jsx)("div",{className:"col",children:"============"})]})}),L.map((function(e,t){return Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row align-items-start",children:[Object(x.jsx)("div",{className:"col",children:e.symbol}),Object(x.jsx)("div",{className:"col",children:e.native.USD}),Object(x.jsx)("div",{className:"col",children:e.rewards.USD}),Object(x.jsx)("div",{className:"col",children:e.total.USD})]})})})),Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row align-items-start",children:[Object(x.jsx)("div",{className:"col",children:"============"}),Object(x.jsx)("div",{className:"col",children:"============"}),Object(x.jsx)("div",{className:"col",children:"============"}),Object(x.jsx)("div",{className:"col",children:"============"})]})}),Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row align-items-start",children:[Object(x.jsx)("div",{className:"col"}),Object(x.jsx)("div",{className:"col",children:J.native}),Object(x.jsx)("div",{className:"col",children:J.rewards}),Object(x.jsx)("div",{className:"col",children:J.sum})]})})]})},I=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,506)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),s(e),n(e),c(e),r(e)}))};r.a.render(Object(x.jsx)(n.a.StrictMode,{children:Object(x.jsx)(B,{})}),document.getElementById("root")),I()}},[[500,1,2]]]);
//# sourceMappingURL=main.80096bac.chunk.js.map